{"version":3,"file":"index.production.js","sources":["../../src/index.ts"],"sourcesContent":["import {\n  elementScroll,\n  observeElementOffset,\n  observeElementRect,\n  observeWindowOffset,\n  observeWindowRect,\n  PartialKeys,\n  Virtualizer,\n  VirtualizerOptions,\n  windowScroll,\n} from '@tanstack/virtual-core'\nimport {\n  computed,\n  onScopeDispose,\n  Ref,\n  shallowRef,\n  triggerRef,\n  unref,\n  watch,\n} from 'vue'\nexport * from '@tanstack/virtual-core'\n\ntype MaybeRef<T> = T | Ref<T>\n\nfunction useVirtualizerBase<\n  TScrollElement extends Element | Window,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<VirtualizerOptions<TScrollElement, TItemElement>>,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  const virtualizer = new Virtualizer(unref(options))\n  const state = shallowRef(virtualizer)\n\n  const cleanup = virtualizer._didMount()\n\n  watch(\n    () => unref(options).getScrollElement(),\n    (el) => {\n      if (el) {\n        virtualizer._willUpdate()\n      }\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  watch(\n    () => unref(options),\n    (options) => {\n      virtualizer.setOptions({\n        ...options,\n        onChange: (instance, sync) => {\n          triggerRef(state)\n          options.onChange?.(instance, sync)\n        },\n      })\n\n      virtualizer._willUpdate()\n      triggerRef(state)\n    },\n    {\n      immediate: true,\n    },\n  )\n\n  onScopeDispose(cleanup)\n\n  return state\n}\n\nexport function useVirtualizer<\n  TScrollElement extends Element,\n  TItemElement extends Element,\n>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<TScrollElement, TItemElement>,\n      'observeElementRect' | 'observeElementOffset' | 'scrollToFn'\n    >\n  >,\n): Ref<Virtualizer<TScrollElement, TItemElement>> {\n  return useVirtualizerBase<TScrollElement, TItemElement>(\n    computed(() => ({\n      observeElementRect: observeElementRect,\n      observeElementOffset: observeElementOffset,\n      scrollToFn: elementScroll,\n      ...unref(options),\n    })),\n  )\n}\n\nexport function useWindowVirtualizer<TItemElement extends Element>(\n  options: MaybeRef<\n    PartialKeys<\n      VirtualizerOptions<Window, TItemElement>,\n      | 'observeElementRect'\n      | 'observeElementOffset'\n      | 'scrollToFn'\n      | 'getScrollElement'\n    >\n  >,\n): Ref<Virtualizer<Window, TItemElement>> {\n  return useVirtualizerBase<Window, TItemElement>(\n    computed(() => ({\n      getScrollElement: () => (typeof document !== 'undefined' ? window : null),\n      observeElementRect: observeWindowRect,\n      observeElementOffset: observeWindowOffset,\n      scrollToFn: windowScroll,\n      initialOffset:\n        typeof document !== 'undefined' ? window.scrollY : undefined,\n      ...unref(options),\n    })),\n  )\n}\n"],"names":["useVirtualizerBase","options","virtualizer","Virtualizer","unref","state","shallowRef","cleanup","_didMount","watch","getScrollElement","el","_willUpdate","immediate","setOptions","_extends","onChange","instance","sync","triggerRef","onScopeDispose","computed","observeElementRect","observeElementOffset","scrollToFn","elementScroll","document","window","observeWindowRect","observeWindowOffset","windowScroll","initialOffset","scrollY","undefined"],"mappings":";;;;;;;;;;8jBAwBA,SAASA,EAIPC,GAEA,IAAMC,EAAc,IAAIC,EAAAA,YAAYC,EAAAA,MAAMH,IACpCI,EAAQC,aAAWJ,GAEnBK,EAAUL,EAAYM,YAmC5B,OAjCAC,EAAAA,OACE,WAAA,OAAML,QAAMH,GAASS,kBACrB,IAAA,SAACC,GACKA,GACFT,EAAYU,aAEhB,GACA,CACEC,WAAW,IAIfJ,EAAAA,OACE,WAAA,OAAML,EAAAA,MAAMH,EACZ,IAAA,SAACA,GACCC,EAAYY,WAAUC,KACjBd,EAAO,CACVe,SAAU,SAACC,EAAUC,GACnBC,EAAUA,WAACd,GACK,MAAhBJ,EAAQe,UAARf,EAAQe,SAAWC,EAAUC,EAC/B,KAGFhB,EAAYU,cACZO,EAAUA,WAACd,EACb,GACA,CACEQ,WAAW,IAIfO,EAAcA,eAACb,GAERF,CACT,kBAEO,SAILJ,GAOA,OAAOD,EACLqB,EAAAA,UAAS,WAAA,OAAAN,EAAA,CACPO,mBAAoBA,EAAkBA,mBACtCC,qBAAsBA,EAAoBA,qBAC1CC,WAAYC,EAAAA,eACTrB,EAAKA,MAACH,GACT,IAEN,yBAEO,SACLA,GAUA,OAAOD,EACLqB,EAAAA,UAAS,WAAA,OAAAN,EAAA,CACPL,iBAAkB,WAAA,MAA2B,oBAAbgB,SAA2BC,OAAS,IAAK,EACzEL,mBAAoBM,EAAiBA,kBACrCL,qBAAsBM,EAAmBA,oBACzCL,WAAYM,EAAYA,aACxBC,cACsB,oBAAbL,SAA2BC,OAAOK,aAAUC,GAClD7B,EAAKA,MAACH,GACT,IAEN"}
import{computed as d,defineComponent as m,Fragment as T,h,inject as H,onMounted as M,provide as B,ref as y,watch as P}from"vue";import{useControllable as j}from'../../hooks/use-controllable.js';import{useId as G}from'../../hooks/use-id.js';import{useResolveButtonType as V}from'../../hooks/use-resolve-button-type.js';import{Features as F,Hidden as I}from'../../internal/hidden.js';import{Keys as b}from'../../keyboard.js';import{dom as O}from'../../utils/dom.js';import{attemptSubmit as A}from'../../utils/form.js';import{compact as $,omit as N,render as v}from'../../utils/render.js';import{Description as U,useDescriptions as _}from'../description/description.js';import{Label as q,useLabels as z}from'../label/label.js';let S=Symbol("GroupContext"),oe=m({name:"SwitchGroup",props:{as:{type:[Object,String],default:"template"}},setup(l,{slots:p,attrs:a}){let o=y(null),f=z({name:"SwitchLabel",props:{htmlFor:d(()=>{var r;return(r=o.value)==null?void 0:r.id}),onClick(r){o.value&&(r.currentTarget.tagName==="LABEL"&&r.preventDefault(),o.value.click(),o.value.focus({preventScroll:!0}))}}}),t=_({name:"SwitchDescription"});return B(S,{switchRef:o,labelledby:f,describedby:t}),()=>v({theirProps:l,ourProps:{},slot:{},slots:p,attrs:a,name:"SwitchGroup"})}}),ie=m({name:"Switch",emits:{"update:modelValue":l=>!0},props:{as:{type:[Object,String],default:"button"},modelValue:{type:Boolean,default:void 0},defaultChecked:{type:Boolean,optional:!0},form:{type:String,optional:!0},name:{type:String,optional:!0},value:{type:String,optional:!0},id:{type:String,default:()=>`headlessui-switch-${G()}`}},inheritAttrs:!1,setup(l,{emit:p,attrs:a,slots:o,expose:f}){let t=H(S,null),[i,r]=j(d(()=>l.modelValue),e=>p("update:modelValue",e),d(()=>l.defaultChecked));function s(){r(!i.value)}let w=y(null),u=t===null?w:t.switchRef,g=V(d(()=>({as:l.as,type:a.type})),u);f({el:u,$el:u});function k(e){e.preventDefault(),s()}function C(e){e.key===b.Space?(e.preventDefault(),s()):e.key===b.Enter&&A(e.currentTarget)}function E(e){e.preventDefault()}let c=d(()=>{var e,n;return(n=(e=O(u))==null?void 0:e.closest)==null?void 0:n.call(e,"form")});return M(()=>{P([c],()=>{if(!c.value||l.defaultChecked===void 0)return;function e(){r(l.defaultChecked)}return c.value.addEventListener("reset",e),()=>{var n;(n=c.value)==null||n.removeEventListener("reset",e)}},{immediate:!0})}),()=>{let{id:e,name:n,value:L,form:D,...R}=l,K={checked:i.value},x={id:e,ref:u,role:"switch",type:g.value,tabIndex:0,"aria-checked":i.value,"aria-labelledby":t==null?void 0:t.labelledby.value,"aria-describedby":t==null?void 0:t.describedby.value,onClick:k,onKeyup:C,onKeypress:E};return h(T,[n!=null&&i.value!=null?h(I,$({features:F.Hidden,as:"input",type:"checkbox",hidden:!0,readOnly:!0,checked:i.value,form:D,name:n,value:L})):null,v({ourProps:x,theirProps:{...a,...N(R,["modelValue","defaultChecked"])},slot:K,attrs:a,slots:o,name:"Switch"})])}}}),ae=q,ue=U;export{ie as Switch,ue as SwitchDescription,oe as SwitchGroup,ae as SwitchLabel};
